---
phase: 28-sympy-removal
plan: 02
type: execute
---

<objective>
Remove SymPy from pint_backend.py completely.

Purpose: pint_backend.py has 148 sympy references. Most are for `evaluate_sympy_ast_with_pint()` which walks SymPy AST - this function is no longer needed since we have the custom parser that produces its own AST.

Output: Zero sympy imports in pint_backend.py
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@src/livemathtex/engine/pint_backend.py
@src/livemathtex/engine/expression_evaluator.py

**Depends on:** 28-01 complete (evaluator.py cleaned)

**Current sympy usage in pint_backend.py:**
- `evaluate_sympy_ast_with_pint()` - walks SymPy AST (~100 lines) - DELETE
- `build_pint_symbol_map()` - builds map from SymPy symbols - DELETE
- `sympy_strip_unit_from_value()` - extracts units from SymPy Quantity - DELETE
- `get_sympy_unit_registry()` - returns UnitRegistry - KEEP but rename
- Unit conversion helpers - may need sympy.physics.units - EVALUATE

**What we KEEP:**
- `get_unit_registry()` / `get_pint_registry()` - pure Pint
- `clean_latex_unit()` - string manipulation, no sympy
- `is_known_unit()` - pure Pint
- `format_unit_latex()` - string manipulation
- `check_variable_name_conflict()` - pure Pint
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete evaluate_sympy_ast_with_pint() and related functions</name>
  <files>src/livemathtex/engine/pint_backend.py</files>
  <action>
Delete these functions entirely (they're only used by the old latex2sympy path):

1. `evaluate_sympy_ast_with_pint()` - the main SymPy AST walker
2. `build_pint_symbol_map()` - builds symbol map from SymPy expressions
3. `sympy_strip_unit_from_value()` - extracts units from SymPy Quantity
4. Any helper functions only used by the above

These are NOT needed anymore - `expression_evaluator.py` does the same thing but with our own AST.
  </action>
  <verify>grep -n "evaluate_sympy_ast_with_pint\|build_pint_symbol_map" src/livemathtex/engine/pint_backend.py returns empty</verify>
  <done>SymPy AST evaluation functions deleted</done>
</task>

<task type="auto">
  <name>Task 2: Remove all sympy imports from pint_backend.py</name>
  <files>src/livemathtex/engine/pint_backend.py</files>
  <action>
Remove ALL sympy imports:

```python
from sympy.physics.units import (...)
import sympy
from sympy import ...
```

Search entire file for `sympy` and remove every occurrence.

If any function still needs SymPy functionality, reimplement using pure Pint.
  </action>
  <verify>grep -c "sympy" src/livemathtex/engine/pint_backend.py returns 0</verify>
  <done>Zero sympy imports in pint_backend.py</done>
</task>

<task type="auto">
  <name>Task 3: Update exports in pint_backend.py</name>
  <files>src/livemathtex/engine/pint_backend.py</files>
  <action>
Update `__all__` and module exports to remove deleted functions.

Keep only pure Pint functions:
- get_unit_registry / get_pint_registry
- clean_latex_unit
- is_known_unit
- format_unit_latex
- check_variable_name_conflict
- UnitRegistry (re-export from pint)
- PintEvaluationError

Remove from exports:
- evaluate_sympy_ast_with_pint
- build_pint_symbol_map
- sympy_strip_unit_from_value
- get_sympy_unit_registry (if different from get_unit_registry)
  </action>
  <verify>python -c "from livemathtex.engine.pint_backend import get_unit_registry; print('OK')"</verify>
  <done>Clean exports, no sympy functions exposed</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `grep -c "sympy" src/livemathtex/engine/pint_backend.py` returns 0
- [ ] `python -c "from livemathtex.engine.pint_backend import get_unit_registry"` works
- [ ] Module imports without errors
</verification>

<success_criteria>
- Zero sympy in pint_backend.py
- Pure Pint unit handling only
- Module still functional for unit operations
</success_criteria>

<output>
After completion, create `.planning/phases/28-table-cell-parsing/28-02-SUMMARY.md`
</output>
