---
phase: 28-sympy-removal
plan: 03
type: execute
---

<objective>
Remove SymPy from remaining files (core.py, token_classifier.py, etc.)

Purpose: Clean up stragglers - files with small amounts of sympy that weren't the main focus.

Output: Zero sympy in ALL source files
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@src/livemathtex/core.py
@src/livemathtex/engine/token_classifier.py

**Depends on:** 28-02 complete

**Remaining sympy usage:**
- core.py: 4 references (sympy imports for some edge case)
- token_classifier.py: 8 references - ENTIRE FILE CAN BE DELETED
- ir/schema.py: 1 reference (just a comment about internal IDs)
- expression_tokenizer.py: 1 reference (just a comment)
- expression_evaluator.py: 1 reference (just a comment)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete token_classifier.py entirely</name>
  <files>src/livemathtex/engine/token_classifier.py</files>
  <action>
Delete the entire file `src/livemathtex/engine/token_classifier.py`.

This module was for detecting when latex2sympy splits multi-letter identifiers (implicit multiplication detection). Since we're removing latex2sympy, this entire module is obsolete.

Also remove from `src/livemathtex/engine/__init__.py`:
- Any import of TokenClassifier
- Any export of TokenClassifier
  </action>
  <verify>ls src/livemathtex/engine/token_classifier.py returns "No such file"</verify>
  <done>token_classifier.py deleted</done>
</task>

<task type="auto">
  <name>Task 2: Remove sympy from core.py</name>
  <files>src/livemathtex/core.py</files>
  <action>
Find and remove all sympy imports and usages in core.py:

```python
import sympy
from sympy.physics.units import convert_to
from sympy.physics import units as u
```

If any functionality needs sympy, replace with pure Pint equivalent.

The core.py file is mostly orchestration - it shouldn't need sympy directly.
  </action>
  <verify>grep -c "sympy" src/livemathtex/core.py returns 0</verify>
  <done>Zero sympy in core.py</done>
</task>

<task type="auto">
  <name>Task 3: Clean up comments mentioning sympy/latex2sympy</name>
  <files>src/livemathtex/</files>
  <action>
Search all source files for comments mentioning sympy or latex2sympy and update or remove them:

```bash
grep -rn "sympy\|latex2sympy" src/livemathtex/ --include="*.py"
```

For each file:
- Remove outdated comments about "latex2sympy compatibility"
- Remove comments about "fallback to sympy"
- Update architecture comments to reflect Pure Pint approach
- Keep comments that are just historical notes (if any)
  </action>
  <verify>grep -r "latex2sympy" src/livemathtex/ --include="*.py" | grep -v "#.*history\|#.*legacy" returns minimal results</verify>
  <done>Comments updated, no misleading sympy references</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] token_classifier.py deleted
- [ ] `grep -c "sympy" src/livemathtex/core.py` returns 0
- [ ] `grep -rn "import sympy\|from sympy" src/livemathtex/` returns nothing
</verification>

<success_criteria>
- token_classifier.py gone
- No sympy imports anywhere in src/livemathtex/
- Comments don't reference sympy as current architecture
</success_criteria>

<output>
After completion, create `.planning/phases/28-table-cell-parsing/28-03-SUMMARY.md`
</output>
